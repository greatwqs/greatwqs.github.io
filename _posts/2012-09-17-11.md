---
layout: post
title: 只在WP主评论加上楼层号的方法『支持顺序、倒序』
date: 2012-09-17 18:34
author: 老杨
comments: true
categories: [wordpress, 老杨转载]
---
今天在修改付费主题 zSnos2.5 时顺便把此主题的“主评论显示楼层号”代码优化了一下，让它<span style = "color:red;">支持评论顺序和倒序</span>。

基础代码可以参考我以前写的 2 篇文章：《<a href="http://zww.me/archives/25161" target="_blank">只在WP主评论加上楼层号的方法（支持评论分页）</a>》，《<a href="http://zww.me/archives/25230" target="_blank">倒序显示主评论楼层号（支持评论分页）</a>》

<!--more-->

<h3>前提条件：</h3>

1. 需要开启嵌套评论和评论分页功能（WP后台 》设置 》讨论）
2. 主题评论调用函数 wp_list_comments() （在 comments.php 文件里）使用了回调函数。具体参考：<a href="http://codex.wordpress.org/Template_Tags/wp_list_comments" target="_blank">http://codex.wordpress.org/Template_Tags/wp_list_comments</a>
3. 此文章所说主题评论是调用所有类型评论：comment、pingback、trackback，如果只是调用 comment 部分，需要对代码稍微修改

下面以官方给出的 wp_list_comments() 回调函数作为例子来说明。

<h3>1. 官方最新的 wp_list_comments() 回调函数代码：（这段代码一般放在主题文件 functions.php）</h3>

<pre style="margin:15px 0;font:100 12px/18px monaco, andale mono, courier new;padding:10px 12px;border:#ccc 1px solid;border-left-width:4px;background-color:#fefefe;box-shadow:0 0 4px #eee;word-break:break-all;word-wrap:break-word;color:#444">function mytheme_comment($comment, $args, $depth) {<br>	$GLOBALS['comment'] = $comment;<br>	extract($args, EXTR_SKIP);<br><br>	if ( 'div' == $args['style'] ) {<br>		$tag = 'div';<br>		$add_below = 'comment';<br>	} else {<br>		$tag = 'li';<br>		$add_below = 'div-comment';<br>	}<br>?&gt;<br>	<span style="color:#170">&lt;</span><span style="color:#00c">&lt;</span><span style="color:#00c">?php</span> <span style="color:#00c">echo</span> <span style="color:#00c">$tag</span> <span style="color:#00c">?</span><span style="color:#170">&gt;</span> <span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_class</span>(<span style="color:#708">empty</span>( <span style="color:#000-2">$args</span>[<span style="color:#a11">'has_children'</span>] ) <span style="color:#000">?</span> <span style="color:#a11">''</span> : <span style="color:#a11">'parent'</span>) <span style="color:#555">?&gt;</span> id="comment-<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_ID</span>() <span style="color:#555">?&gt;</span>"&gt;<br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> ( <span style="color:#a11">'div'</span> <span style="color:#000">!=</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'style'</span>] ) : <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">id</span>=<span style="color:#a11">"div-comment-&lt;?php comment_ID() ?&gt;"</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-body"</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">endif</span>; <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-author vcard"</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> (<span style="color:#000-2">$args</span>[<span style="color:#a11">'avatar_size'</span>] <span style="color:#000">!=</span> <span style="color:#164">0</span>) <span style="color:#708">echo</span> <span style="color:#@cm-word">get_avatar</span>( <span style="color:#000-2">$comment</span>, <span style="color:#000-2">$args</span>[<span style="color:#a11">'avatar_size'</span>] ); <span style="color:#555">?&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">printf</span>(<span style="color:#@cm-word">__</span>(<span style="color:#a11">'&lt;cite class="fn"&gt;%s&lt;/cite&gt; &lt;span class="says"&gt;says:&lt;/span&gt;'</span>), <span style="color:#@cm-word">get_comment_author_link</span>()) <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br><span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> (<span style="color:#000-2">$comment</span><span style="color:#000">-&gt;</span><span style="color:#@cm-word">comment_approved</span> <span style="color:#000">==</span> <span style="color:#a11">'0'</span>) : <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;em</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-awaiting-moderation"</span><span style="color:#170">&gt;</span><span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">_e</span>(<span style="color:#a11">'Your comment is awaiting moderation.'</span>) <span style="color:#555">?&gt;</span><span style="color:#170">&lt;/em</span><span style="color:#170">&gt;</span><br>	<span style="color:#170">&lt;br</span> <span style="color:#170">/&gt;</span><br><span style="color:#555">&lt;?php</span> <span style="color:#708">endif</span>; <span style="color:#555">?&gt;</span><br><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-meta commentmetadata"</span><span style="color:#170">&gt;</span><span style="color:#170">&lt;a</span> <span style="color:#00c">href</span>=<span style="color:#a11">"&lt;?php echo htmlspecialchars( get_comment_link( $comment-&gt;comment_ID ) ) ?&gt;"</span><span style="color:#170">&gt;</span><br>		<span style="color:#555">&lt;?php</span><br>			<span style="color:#a50">/* translators: 1: date, 2: time */</span><br>			<span style="color:#@cm-word">printf</span>( <span style="color:#@cm-word">__</span>(<span style="color:#a11">'%1$s at %2$s'</span>), <span style="color:#@cm-word">get_comment_date</span>(),  <span style="color:#@cm-word">get_comment_time</span>()) <span style="color:#555">?&gt;</span><span style="color:#170">&lt;/a</span><span style="color:#170">&gt;</span><span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">edit_comment_link</span>(<span style="color:#@cm-word">__</span>(<span style="color:#a11">'(Edit)'</span>),<span style="color:#a11">'  '</span>,<span style="color:#a11">''</span> );<br>		<span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br><br>	<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_text</span>() <span style="color:#555">?&gt;</span><br><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">class</span>=<span style="color:#a11">"reply"</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_reply_link</span>(<span style="color:#@cm-word">array_merge</span>( <span style="color:#000-2">$args</span>, <span style="color:#708">array</span>(<span style="color:#a11">'add_below'</span> <span style="color:#000">=&gt;</span> <span style="color:#000-2">$add_below</span>, <span style="color:#a11">'depth'</span> <span style="color:#000">=&gt;</span> <span style="color:#000-2">$depth</span>, <span style="color:#a11">'max_depth'</span> <span style="color:#000">=&gt;</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'max_depth'</span>]))) <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> ( <span style="color:#a11">'div'</span> <span style="color:#000">!=</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'style'</span>] ) : <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">endif</span>; <span style="color:#555">?&gt;</span><br><span style="color:#555">&lt;?php</span><br>	}</pre>	

<h3>2. 然后在 $GLOBALS['comment'] = $comment; 这句下面添加楼层号处理函数，具体看下面修改好的的代码，标注 （加处理），共3处。</h3>

<pre style="margin:15px 0;font:100 12px/18px monaco, andale mono, courier new;padding:10px 12px;border:#ccc 1px solid;border-left-width:4px;background-color:#fefefe;box-shadow:0 0 4px #eee;word-break:break-all;word-wrap:break-word;color:#444"><span style="color:#555">&lt;?php</span><br><span style="color:#708">function</span> <span style="color:#@cm-word">mytheme_comment</span>(<span style="color:#000-2">$comment</span>, <span style="color:#000-2">$args</span>, <span style="color:#000-2">$depth</span>) {<br>	<span style="color:#000-2">$GLOBALS</span>[<span style="color:#a11">'comment'</span>] <span style="color:#000">=</span> <span style="color:#000-2">$comment</span>;<br><br>	 <span style="color:#a50">//（加处理-开始）主评论计数器 by zwwooooo</span><br>	<span style="color:#708">global</span> <span style="color:#000-2">$commentcount</span>, <span style="color:#000-2">$page</span>, <span style="color:#000-2">$wpdb</span>;<br>	<span style="color:#708">if</span> ( (<span style="color:#@cm-word">int</span>) <span style="color:#@cm-word">get_option</span>(<span style="color:#a11">'page_comments'</span>) <span style="color:#000">===</span> <span style="color:#164">1</span> <span style="color:#000">&amp;&amp;</span> (<span style="color:#@cm-word">int</span>) <span style="color:#@cm-word">get_option</span>(<span style="color:#a11">'thread_comments'</span>) <span style="color:#000">===</span> <span style="color:#164">1</span> ) { <span style="color:#a50">//开启嵌套评论和分页才启用</span><br>		<span style="color:#708">if</span>(<span style="color:#000">!</span><span style="color:#000-2">$commentcount</span>) { <span style="color:#a50">//初始化楼层计数器</span><br>			<span style="color:#000-2">$page</span> <span style="color:#000">=</span> ( <span style="color:#000">!</span><span style="color:#708">empty</span>(<span style="color:#000-2">$in_comment_loop</span>) ) <span style="color:#000">?</span> <span style="color:#@cm-word">get_query_var</span>(<span style="color:#a11">'cpage'</span>) : <span style="color:#@cm-word">get_page_of_comment</span>( <span style="color:#000-2">$comment</span><span style="color:#000">-&gt;</span><span style="color:#@cm-word">comment_ID</span>, <span style="color:#000-2">$args</span> ); <span style="color:#a50">//获取当前评论列表页码</span><br>			<span style="color:#000-2">$cpp</span> <span style="color:#000">=</span> <span style="color:#@cm-word">get_option</span>(<span style="color:#a11">'comments_per_page'</span>); <span style="color:#a50">//获取每页评论显示数量</span><br>			<span style="color:#708">if</span> ( <span style="color:#@cm-word">get_option</span>(<span style="color:#a11">'comment_order'</span>) <span style="color:#000">===</span> <span style="color:#a11">'desc'</span> ) { <span style="color:#a50">//倒序</span><br>				<span style="color:#000-2">$comments</span> <span style="color:#000">=</span> <span style="color:#000-2">$wpdb</span><span style="color:#000">-&gt;</span><span style="color:#@cm-word">get_results</span>(<span style="color:#a11">"SELECT * FROM $wpdb-&gt;comments WHERE comment_post_ID = $post-&gt;ID AND comment_type = 'all' AND comment_approved = '1' AND !comment_parent"</span>);<br>				<span style="color:#000-2">$cnt</span> <span style="color:#000">=</span> <span style="color:#@cm-word">count</span>(<span style="color:#000-2">$comments</span>); <span style="color:#a50">//获取主评论总数量</span><br>				<span style="color:#708">if</span> (<span style="color:#@cm-word">ceil</span>(<span style="color:#000-2">$cnt</span> <span style="color:#000">/</span> <span style="color:#000-2">$cpp</span>) <span style="color:#000">==</span> <span style="color:#164">1</span> <span style="color:#000">

</span> (<span style="color:#000-2">$page</span> <span style="color:#000">&gt;</span> <span style="color:#164">1</span> <span style="color:#000">&amp;&amp;</span> <span style="color:#000-2">$page</span>  <span style="color:#000">==</span> <span style="color:#@cm-word">ceil</span>(<span style="color:#000-2">$cnt</span> <span style="color:#000">/</span> <span style="color:#000-2">$cpp</span>))) { <span style="color:#a50">//如果评论只有1页或者是最后一页，初始值为主评论总数</span><br>					<span style="color:#000-2">$commentcount</span> <span style="color:#000">=</span> <span style="color:#000-2">$cnt</span> <span style="color:#000">+</span> <span style="color:#164">1</span>;<br>				} <span style="color:#708">else</span> {<br>					<span style="color:#000-2">$commentcount</span> <span style="color:#000">=</span> <span style="color:#000-2">$cpp</span> <span style="color:#000">*</span> <span style="color:#000-2">$page</span> <span style="color:#000">+</span> <span style="color:#164">1</span>;<br>				}<br>			} <span style="color:#708">else</span> {<br>				<span style="color:#000-2">$commentcount</span> <span style="color:#000">=</span> <span style="color:#000-2">$cpp</span> <span style="color:#000">*</span> (<span style="color:#000-2">$page</span> <span style="color:#000">-</span> <span style="color:#164">1</span>);<br>			}<br>		}<br>		<span style="color:#708">if</span> ( <span style="color:#000">!</span><span style="color:#000-2">$parent_id</span> <span style="color:#000">=</span> <span style="color:#000-2">$comment</span><span style="color:#000">-&gt;</span><span style="color:#@cm-word">comment_parent</span> ) {<br>			<span style="color:#000-2">$commentcountText</span> <span style="color:#000">=</span> <span style="color:#a11">'&lt;div class="floor"&gt;'</span>;<br>			<span style="color:#708">if</span> ( <span style="color:#@cm-word">get_option</span>(<span style="color:#a11">'comment_order'</span>) <span style="color:#000">===</span> <span style="color:#a11">'desc'</span> ) { <span style="color:#a50">//倒序</span><br>				<span style="color:#000-2">$commentcountText</span> .<span style="color:#000">=</span> <span style="color:#000">--</span><span style="color:#000-2">$commentcount</span> . <span style="color:#a11">'楼'</span>;<br>			} <span style="color:#708">else</span> {<br>				<span style="color:#708">switch</span> (<span style="color:#000-2">$commentcount</span>) {<br>					<span style="color:#708">case</span> <span style="color:#164">0</span>:<br>						<span style="color:#000-2">$commentcountText</span> .<span style="color:#000">=</span> <span style="color:#a11">'&lt;span&gt;沙发！&lt;/span&gt;'</span>; <span style="color:#000">++</span><span style="color:#000-2">$commentcount</span>;<br>						<span style="color:#708">break</span>;<br>					<span style="color:#708">case</span> <span style="color:#164">1</span>:<br>						<span style="color:#000-2">$commentcountText</span> .<span style="color:#000">=</span> <span style="color:#a11">'&lt;span&gt;板凳！&lt;/span&gt;'</span>; <span style="color:#000">++</span><span style="color:#000-2">$commentcount</span>;<br>						<span style="color:#708">break</span>;<br>					<span style="color:#708">case</span> <span style="color:#164">2</span>:<br>						<span style="color:#000-2">$commentcountText</span> .<span style="color:#000">=</span> <span style="color:#a11">'&lt;span&gt;地板！&lt;/span&gt;'</span>; <span style="color:#000">++</span><span style="color:#000-2">$commentcount</span>;<br>						<span style="color:#708">break</span>;<br>					<span style="color:#708">default</span>:<br>						<span style="color:#000-2">$commentcountText</span> .<span style="color:#000">=</span> <span style="color:#000">++</span><span style="color:#000-2">$commentcount</span> . <span style="color:#a11">'楼'</span>;<br>						<span style="color:#708">break</span>;<br>				}<br>			}<br>			<span style="color:#000-2">$commentcountText</span> .<span style="color:#000">=</span> <span style="color:#a11">'&lt;/div"&gt;'</span>;<br>		}<br>	}<span style="color:#a50">//（加处理-结束）</span><br><br>	<span style="color:#@cm-word">extract</span>(<span style="color:#000-2">$args</span>, <span style="color:#@cm-word">EXTR_SKIP</span>);<br><br>	<span style="color:#708">if</span> ( <span style="color:#a11">'div'</span> <span style="color:#000">==</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'style'</span>] ) {<br>		<span style="color:#000-2">$tag</span> <span style="color:#000">=</span> <span style="color:#a11">'div'</span>;<br>		<span style="color:#000-2">$add_below</span> <span style="color:#000">=</span> <span style="color:#a11">'comment'</span>;<br>	} <span style="color:#708">else</span> {<br>		<span style="color:#000-2">$tag</span> <span style="color:#000">=</span> <span style="color:#a11">'li'</span>;<br>		<span style="color:#000-2">$add_below</span> <span style="color:#000">=</span> <span style="color:#a11">'div-comment'</span>;<br>	}<br><span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;</span><span style="color:#00c">&lt;</span><span style="color:#00c">?php</span> <span style="color:#00c">echo</span> <span style="color:#00c">$tag</span> <span style="color:#00c">?</span><span style="color:#170">&gt;</span> <span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_class</span>(<span style="color:#708">empty</span>( <span style="color:#000-2">$args</span>[<span style="color:#a11">'has_children'</span>] ) <span style="color:#000">?</span> <span style="color:#a11">''</span> : <span style="color:#a11">'parent'</span>) <span style="color:#555">?&gt;</span> id="comment-<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_ID</span>() <span style="color:#555">?&gt;</span>"&gt;<br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> ( <span style="color:#a11">'div'</span> <span style="color:#000">!=</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'style'</span>] ) : <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">id</span>=<span style="color:#a11">"div-comment-&lt;?php comment_ID() ?&gt;"</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-body"</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">endif</span>; <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-author vcard"</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> (<span style="color:#000-2">$args</span>[<span style="color:#a11">'avatar_size'</span>] <span style="color:#000">!=</span> <span style="color:#164">0</span>) <span style="color:#708">echo</span> <span style="color:#@cm-word">get_avatar</span>( <span style="color:#000-2">$comment</span>, <span style="color:#000-2">$args</span>[<span style="color:#a11">'avatar_size'</span>] ); <span style="color:#555">?&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">printf</span>(<span style="color:#@cm-word">__</span>(<span style="color:#a11">'&lt;cite class="fn"&gt;%s&lt;/cite&gt; &lt;span class="says"&gt;says:&lt;/span&gt;'</span>), <span style="color:#@cm-word">get_comment_author_link</span>()) <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br><span style="color:#555">&lt;?php</span> <span style="color:#708">if</span> (<span style="color:#000-2">$comment</span><span style="color:#000">-&gt;</span><span style="color:#@cm-word">comment_approved</span> <span style="color:#000">==</span> <span style="color:#a11">'0'</span>) : <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;em</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-awaiting-moderation"</span><span style="color:#170">&gt;</span><span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">_e</span>(<span style="color:#a11">'Your comment is awaiting moderation.'</span>) <span style="color:#555">?&gt;</span><span style="color:#170">&lt;/em</span><span style="color:#170">&gt;</span><br>	<span style="color:#170">&lt;br</span> <span style="color:#170">/&gt;</span><br><span style="color:#555">&lt;?php</span> <span style="color:#708">endif</span>; <span style="color:#555">?&gt;</span><br><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">class</span>=<span style="color:#a11">"comment-meta commentmetadata"</span><span style="color:#170">&gt;</span><span style="color:#170">&lt;a</span> <span style="color:#00c">href</span>=<span style="color:#a11">"&lt;?php echo htmlspecialchars( get_comment_link( $comment-&gt;comment_ID ) ) ?&gt;"</span><span style="color:#170">&gt;</span><br>		<span style="color:#555">&lt;?php</span><br>			<span style="color:#a50">/* translators: 1: date, 2: time */</span><br>			<span style="color:#@cm-word">printf</span>( <span style="color:#@cm-word">__</span>(<span style="color:#a11">'%1$s at %2$s'</span>), <span style="color:#@cm-word">get_comment_date</span>(),  <span style="color:#@cm-word">get_comment_time</span>()) <span style="color:#555">?&gt;</span><span style="color:#170">&lt;/a</span><span style="color:#170">&gt;</span><span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">edit_comment_link</span>(<span style="color:#@cm-word">__</span>(<span style="color:#a11">'(Edit)'</span>),<span style="color:#a11">'  '</span>,<span style="color:#a11">''</span> );<br>		<span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br><br>	<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_text</span>() <span style="color:#555">?&gt;</span><br><br>	<span style="color:#170">&lt;div</span> <span style="color:#00c">class</span>=<span style="color:#a11">"reply"</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#@cm-word">comment_reply_link</span>(<span style="color:#@cm-word">array_merge</span>( <span style="color:#000-2">$args</span>, <span style="color:#708">array</span>(<span style="color:#a11">'add_below'</span> <span style="color:#000">=&gt;</span> <span style="color:#000-2">$add_below</span>, <span style="color:#a11">'depth'</span> <span style="color:#000">=&gt;</span> <span style="color:#000-2">$depth</span>, <span style="color:#a11">'max_depth'</span> <span style="color:#000">=&gt;</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'max_depth'</span>]))) <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">echo</span> <span style="color:#000-2">$commentcountText</span>; <span style="color:#a50">//主评论楼层号 - //（加处理） ?&gt;</span><br><br>	<span style="color:#000">&lt;?</span><span style="color:#@cm-word">php</span> <span style="color:#708">if</span> ( <span style="color:#a11">'div'</span> <span style="color:#000">!=</span> <span style="color:#000-2">$args</span>[<span style="color:#a11">'style'</span>] ) : <span style="color:#555">?&gt;</span><br>	<span style="color:#170">&lt;/div</span><span style="color:#170">&gt;</span><br>	<span style="color:#555">&lt;?php</span> <span style="color:#708">endif</span>; <span style="color:#555">?&gt;</span><br><span style="color:#555">&lt;?php</span><br>	}</pre>

注：（底部显示位置可以自己根据自己所用主题选择，这里我加在回复按钮后面，另外楼层显示样式可以通过 floor 这个 class 定义）

就这样吧，现在折腾 WordPress 的朋友少了很多，新朋友参考一下吧。

via zww - http://zww.me/archives/25716
